import{_ as e,d as t,f as n,g as r,h as i,m as a,p as o,u as s,v as c}from"./show-BW1-mfQd.js";import{U as l,V as u,d,i as f,l as p,o as m}from"./index-CWN-LTCY.js";var h=l(u());function g(l,u,g){let _=c(),v=e(),y=f(g),b=y.defaultQueryOptions(l);y.getDefaultOptions().queries?._experimental_beforeQuery?.(b),b._optimisticResults=_?`isRestoring`:`optimistic`,s(b),a(b,v),r(v);let x=!y.getQueryCache().get(b.queryHash),[S]=h.useState(()=>new u(y,b)),C=S.getOptimisticResult(b),w=!_&&l.subscribed!==!1;if(h.useSyncExternalStore(h.useCallback(e=>{let t=w?S.subscribe(m.batchCalls(e)):d;return S.updateResult(),t},[S,w]),()=>S.getCurrentResult(),()=>S.getCurrentResult()),h.useEffect(()=>{S.setOptions(b)},[b,S]),n(b,C))throw t(b,S,v);if(i({result:C,errorResetBoundary:v,throwOnError:b.throwOnError,query:y.getQueryCache().get(b.queryHash),suspense:b.suspense}))throw C.error;return y.getDefaultOptions().queries?._experimental_afterQuery?.(b,C),b.experimental_prefetchInRender&&!p&&o(C,_)&&(x?t(b,S,v):y.getQueryCache().get(b.queryHash)?.promise)?.catch(d).finally(()=>{S.updateResult()}),b.notifyOnChangeProps?C:S.trackResult(C)}export{g as t};